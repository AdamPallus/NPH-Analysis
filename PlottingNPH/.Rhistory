leadtime<-dynamiclead(temp)
temp<-mutate(temp,
sdflag=lag(sdf,leadtime),
s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2),
time=row_number(),
verg.angle=rep-lep,
verg.velocity=parabolicdiff(verg.angle,7),
isfixation=s<0,
s=abs(s))
t <-rbind(t,temp)
}
head(t)
t%>%
filter(isfixation == F, s<10) -> p
ggplot(p, aes(time)) + geom_line(aes(rep),color='r')
ggplot(p, aes(time)) + geom_line(aes(time,rep),color='r')
ggplot(p, aes(time)) + geom_line(aes(time,rep),color=r)
ggplot(p, aes(time)) + geom_line(aes(time,rep),color=red)
ggplot(aes(time),data=p)+geom_line(aes(time,rep),color='red')
ggplot(aes(time),data=p)+
geom_line(aes(time,rep),color='red')+
geom_line(aes(time,lep),color='blue')
head(p)
max(p$sdf)
max(p$s)
qplot(p$time)
t%>%
filter(isfixation == F, s<10) %>%
group_by(neuron,s) %>%
mutate(counter=time-time[1])->
p
ggplot(aes(counter),data=p)+
geom_line(aes(counter,rep),color='red')+
geom_line(aes(counter,lep),color='blue')
ggplot(aes(counter),data=p)+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')
ggplot(aes(counter),data=p)+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf))
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,40)) %>%
filter(isfixation == F, s<3) %>%
group_by(neuron,s) %>%
mutate(counter=time-time[1])->
p
ggplot(aes(counter),data=p)+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf))
head(p)
max(p$s)
min(p$s)
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,40),
isfixation=s<0,
s=abs(s)) %>%
filter(isfixation == F, s<3) %>%
group_by(neuron,s) %>%
mutate(counter=time-time[1])->
p
ggplot(aes(counter),data=p)+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf))
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s)) %>%
filter(isfixation == F, s<3) %>%
group_by(neuron,s) %>%
mutate(counter=time-time[1])->
p
ggplot(aes(counter),data=p)+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf))
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(counter=time-time[1])->
p
nsac <- 10
ggplot(aes(counter),data=filter(p,s<=nsac))+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf))
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(counter=time-time[1])->
p
nsac <- 10
ggplot(aes(counter),data=filter(p,s<=nsac))+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf))
ggplot(aes(counter),data=filter(p,s<=nsac))+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf/10))
nsac <- 100
ggplot(aes(counter),data=filter(p,s<=nsac))+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf/10))
head(p)
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1]
counter=time-time[1]) ->
p
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
counter=time-time[1]) ->
p
qplot(p$verg.amp)
ggplot(aes(counter),data=filter(p,s<=nsac,verg.amp>5))+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf/10))
ggplot(aes(counter),data=filter(p,verg.amp>5,maxamp>5))+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf/10))
qplot(p$maxamp)
ggplot(aes(counter),data=filter(p,verg.amp>3,maxamp>5))+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf/10))
ggplot(aes(counter),data=filter(p,maxamp>5))+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf/10))
p %>%
filter(verg.amp>3) %>%
group_by(counter) %>%
summarize(meanFR=mean(sdf)) ->
averagep
qplot(aes(counter),data=averagep) + geom_point(aes(counter,sdf))
head(averagep)
qplot(aes(counter),data=averagep) + geom_point(aes(counter,meanFR))
qplot(counter,meanFR,data=averagep)
qplot(counter,meanFR,data=averagep,geom='line')
p %>%
filter(verg.amp<3) %>%
group_by(counter) %>%
summarize(meanFR=mean(sdf)) ->
novergaverage
qplot(counter,meanFR,data=novergaverage,geom='line')
forplot <- left_join(averagep,novergaverage,by='counter')
head(forplot)
ggplot(aes(counter),data=forplot)+geom_line(aes(counter,meanFR.x))
ggplot(aes(counter),data=forplot)+geom_line(aes(counter,meanFR.x))+geom_line(aes(counter,meanFR.y))
qplot(maxamp,maxfr,data=p)
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1]) ->
p
qplot(maxamp,maxfr,data=p)
qplot(verg.amp,maxfr,data=p)
qplot(R.H.Amp,data=p)
forplot <- left_join(convergent,divergent,by='counter')
p %>%
filter(verg.amp>3) %>%
group_by(counter) %>%
summarize(convergent=mean(sdf)) ->
convergent
p %>%
filter(verg.amp< -3) %>%
group_by(counter) %>%
summarize(divergent=mean(sdf)) ->
divergent
forplot <- left_join(convergent,divergent,by='counter')
qplot(counter,m)
qplot(counter,m,data=forplot)
head(forplot)
qplot(counter,convergent,data=forplot)
qplot(counter,convergent,data=forplot)+geom_point(divergent)
qplot(counter,convergent,data=forplot)+geom_point(y=divergent)
qplot(counter,convergent,data=forplot)+geom_point(aes(y=divergent))
forplot <- left_join(convergent,divergent,by='counter')
forplot <- left_join(forplot,version,by='counter')
gather(forplot,"peak.firing.rate","saccade.type",2:4)
p %>%
filter(verg.amp>3) %>%
group_by(counter) %>%
summarize(convergent=mean(sdf)) ->
convergent
p %>%
filter(verg.amp< -3) %>%
group_by(counter) %>%
summarize(divergent=mean(sdf)) ->
divergent
p %>%
filter(verg.amp>3, verg.amp< -3) %>%
group_by(counter) %>%
summarize(version=mean(sdf)) ->
version
forplot <- left_join(convergent,divergent,by='counter')
forplot <- left_join(forplot,version,by='counter')
gather(forplot,"peak.firing.rate","saccade.type",2:4
)
gather(forplot,"saccade.type","peak.firing.rate",2:4)
forplot <- gather(forplot,"saccade.type","peak.firing.rate",2:4)
qplot(counter,peak.firing.rate,data=forplot)
p %>%
filter(verg.amp>3) %>%
group_by(counter) %>%
summarize(convergent=mean(sdf)) ->
convergent
p %>%
filter(verg.amp< -3) %>%
group_by(counter) %>%
summarize(divergent=mean(sdf)) ->
divergent
p %>%
filter(verg.amp>3, verg.amp< -3) %>%
group_by(counter) %>%
summarize(version=mean(sdf)) ->
version
forplot <- left_join(convergent,divergent,by='counter')
forplot <- left_join(forplot,version,by='counter')
forplot <- gather(forplot,"saccade.type","peak.firing.rate",2:4)
qplot(counter,peak.firing.rate,data=forplot)
qplot(counter,peak.firing.rate,data=filter(forplot,saccade.type=='version'))
p %>%
filter(verg.amp>3) %>%
group_by(counter) %>%
summarize(convergent=mean(sdf)) ->
convergent
p %>%
filter(verg.amp< -3) %>%
group_by(counter) %>%
summarize(divergent=mean(sdf)) ->
divergent
p %>%
filter(verg.amp<3, verg.amp> -3) %>%
group_by(counter) %>%
summarize(version=mean(sdf)) ->
version
forplot <- left_join(convergent,divergent,by='counter')
forplot <- left_join(forplot,version,by='counter')
forplot <- gather(forplot,"saccade.type","peak.firing.rate",2:4)
qplot(counter,peak.firing.rate,data=forplot)
qplot(counter,peak.firing.rate,data=forplot,color=saccade.type)
?dplyr::filter
head(p)
p$saccade.type='version'
p$saccade.type[verg.amp>3]='convergent'
p$saccade.type[p$verg.amp>3]='convergent'
p$saccade.type[p$verg.amp<-3] = 'divergent'
p$saccade.type[p$verg.amp< -3] = 'divergent'
g<- ggplot(aes(counter,sdf),data=p)
g+stat_smooth(method='lm')
g+stat_smooth()
g+stat_smooth(color=saccade.type)
g+stat_smooth(aes(color=saccade.type))
min(p$verg.amp)
p %>%
filter(verg.amp>3) %>%
group_by(counter) %>%
summarize(convergent=mean(sdf)) ->
convergent
p %>%
filter(verg.amp< -3) %>%
group_by(counter) %>%
summarize(divergent=mean(sdf)) ->
divergent
p %>%
filter(verg.amp<3, verg.amp> -3) %>%
group_by(counter) %>%
summarize(version=mean(sdf)) ->
version
forplot <- left_join(convergent,divergent,by='counter')
forplot <- left_join(forplot,version,by='counter')
forplot <- gather(forplot,"saccade.type","peak.firing.rate",2:4)
qplot(counter,peak.firing.rate,data=forplot,color=saccade.type)
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1]) ->
p
p %>%
filter(verg.amp>3) %>%
group_by(counter) %>%
summarize(convergent=mean(sdf)) ->
convergent
p %>%
filter(verg.amp< -3) %>%
group_by(counter) %>%
summarize(divergent=mean(sdf)) ->
divergent
p %>%
filter(verg.amp<3, verg.amp> -3) %>%
group_by(counter) %>%
summarize(version=mean(sdf)) ->
version
forplot <- left_join(convergent,divergent,by='counter')
forplot <- left_join(forplot,version,by='counter')
forplot <- gather(forplot,"saccade.type","peak.firing.rate",2:4)
qplot(counter,peak.firing.rate,data=forplot,color=saccade.type)
ggplot(aes(counter),data=filter(p,verg.amp>3,maxamp>5))+
geom_point(aes(counter,rep),color='red')+
geom_point(aes(counter,lep),color='blue')+
geom_point(aes(counter,sdf/10))
p$saccade.type='version'
p$saccade.type[p$verg.amp>3]='convergent'
p$saccade.type[p$verg.amp< -3] = 'divergent'
g<- ggplot(aes(counter,sdf),data=p)
g+stat_smooth(aes(color=saccade.type))
g+stat_smooth(aes(color=saccade.type,width=3))
g+stat_smooth(aes(color=saccade.type,line.width=3))
?stat.smooth
?ggplot2::stat_smooth
g+stat_smooth(aes(color=saccade.type,size=3))
g+stat_smooth(aes(color=saccade.type,size=2))
g+stat_smooth(color=p$saccade.type,size=2)
g+stat_smooth(color=p$saccade.type,method='auto')
g+stat_smooth(method='auto')
g+stat_smooth(method='auto',aes(color=saccade.type))
g+stat_smooth(method='auto',size=2,aes(color=saccade.type))
g+stat_smooth(method='gam',size=2,aes(color=saccade.type))
g+stat_smooth(method='auto',size=2,aes(color=saccade.type))
g+stat_smooth(method='mean',size=2,aes(color=saccade.type))
?stat_smooth
g+stat_smooth(method='auto',size=2,aes(color=saccade.type))
p %>%
filter(R.H.Amp > 10) %>%
mutate(testcol='hello') %>%
filter(R.H.Amp <= 10) %>%
mutate(testcol='goodbye') -
testp
p %>%
filter(R.H.Amp > 10) %>%
mutate(testcol='hello') %>%
filter(R.H.Amp <= 10) %>%
mutate(testcol='goodbye') ->
testp
nrow(p)
nrow(testp)
?unfilter
?replace
p %>%
mutate(testcol='hello') ->
pp
head(pp)
pp$testcol[1:10]
p %>%
mutate(filter(.,verg.amp>3),saccade.type='convergent')->
pp
p %>%
mutate(filter(.,verg.amp>3),testtest='convergent')->
pp
p %>%
mutate(saccade.type='version') %>%
mutate(filter(.,verg.amp>3),testtest='convergent')->
pp
p %>%
mutate(saccade.type='version') %>%
replace(saccade.type,verg.amp>3,'convergent') ->
pp
p %>%
mutate(saccade.type='version') %>%
replace(.$saccade.type,verg.amp>3,'convergent') ->
pp
p %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp>3,'convergent') ->
pp
p %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp>3,'convergent')) ->
pp
head(pp)
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1]) ->
p
p %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp>3,'convergent'),
saccade.type=replace(saccade.type,verg.amp< -3, 'divergent')) ->
pp
min(pp$saccade.type)
max(pp$saccade.type)
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1],
saccade.type='version',
saccade.type=replace(saccade.type,verg.amp>3,'convergent'),
saccade.type=replace(saccade.type,verg.amp< -3, 'divergent'))->
p
g<- ggplot(aes(counter,sdf),data=p)
g+stat_smooth(method='auto',size=2,aes(color=saccade.type))
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1],
saccade.type='version',
saccade.type=replace(saccade.type,verg.amp>3,'convergence'),
saccade.type=replace(saccade.type,verg.amp< -3, 'divergence'))->
p
g<- ggplot(aes(counter,sdf),data=p)
g+stat_smooth(method='auto',size=2,aes(color=saccade.type))
t%>%
group_by(neuron) %>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1]) ->
p
?facet.wrap
?facet_wrap
?geom_point
