verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1],
saccade.type='version',
saccade.type=replace(saccade.type,verg.amp>3,'convergence'),
saccade.type=replace(saccade.type,verg.amp< -3, 'divergence'))->
p
mean(p$dur)
t%>%
mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,buffer=100,threshold=40),
isfixation=s<0,
s=abs(s),
sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(dur=n(),
R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1],
saccade.type='version',
saccade.type=replace(saccade.type,verg.amp>3,'convergence'),
saccade.type=replace(saccade.type,verg.amp< -3, 'divergence'))->
p
mean(p$dur)
qplot(p$counter,p$rep)
qplot(counter,rep,data=filter(p,s<10))
qplot(counter,rep,data=filter(p,dur<80))
qplot(counter,rep,data=filter(p,dur<280))
qplot(counter,rep,data=filter(p,dur<250))
qplot(counter,rep,data=filter(p,dur<230))
qplot(counter,rep,data=filter(p,dur<230))
qplot(counter,rep,data=filter(p,dur<210))
qplot(counter,rep,data=filter(p,dur<200))
g<- ggplot(aes(counter,sdf),data=p)
g+stat_smooth(method='auto',size=2,aes(color=saccade.type))
g<- ggplot(aes(counter,sdf),data=filter(p,dur<280))
g+stat_smooth(method='auto',size=2,aes(color=saccade.type))
g<- ggplot(aes(counter,sdf),data=filter(p,dur<270))
g+stat_smooth(method='auto',size=2,aes(color=saccade.type))
temp=list()
temp[1]=1:100
temp[1]={1:100}
temp[1]=[[1:100]]
temp[1]<- [[1:100]]
temp[[1]]<- 1:10
qplot(R.H.Amp,maxfr,data=filter(p,abs(R.H.Amp)>3))+facet_wrap(~neuron,ncol=2)
t%>%
group_by(neuron) %>%
#   mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
#          isfixation=s<0,
#          s=abs(s),
#          sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(dur=n(),
peak.R.H<- maxabs(rev),
peak.R.V<- maxabs(revV),
R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
nspikes=sum(rasters),
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1])%>%
group_by(neuron) %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp > 2,'convergence'),
saccade.type=replace(saccade.type,verg.amp < -2, 'divergence'))->
p
maxabs<- function(x){
m1<-max(x,na.rm=T)
m2<-min(x,na.rm=T)
if (abs(m1)>abs(m2)) {
return(m1)
} else{
return(m2)
}
}
t%>%
group_by(neuron) %>%
#   mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
#          isfixation=s<0,
#          s=abs(s),
#          sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(dur=n(),
peak.R.H<- maxabs(rev),
peak.R.V<- maxabs(revV),
R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
nspikes=sum(rasters),
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1])%>%
group_by(neuron) %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp > 2,'convergence'),
saccade.type=replace(saccade.type,verg.amp < -2, 'divergence'))->
p
qplot(peak.R.H,maxfr,data=p)
t%>%
group_by(neuron) %>%
#   mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
#          isfixation=s<0,
#          s=abs(s),
#          sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(dur=n(),
peak.R.H<- maxabs(rev),
peak.R.V<- maxabs(revV),
R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
nspikes=sum(rasters),
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1])%>%
group_by(neuron) %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp > 2,'convergence'),
saccade.type=replace(saccade.type,verg.amp < -2, 'divergence'))->
p
qplot(peak.R.H,maxfr,data=p)
head(p)
t%>%
group_by(neuron) %>%
#   mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
#          isfixation=s<0,
#          s=abs(s),
#          sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(dur=n(),
peak.R.H= maxabs(rev),
peak.R.V= maxabs(revV),
R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
nspikes=sum(rasters),
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
maxfr=max(sdf),
counter=time-time[1])%>%
group_by(neuron) %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp > 2,'convergence'),
saccade.type=replace(saccade.type,verg.amp < -2, 'divergence'))->
p
qplot(peak.R.H,maxfr,data=p)
qplot(peak.R.H,maxfr,data=filter(p,peak.R.H>50))
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50))
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50),color=saccade.type)
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50),color=saccade.type,size=3)
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50),color=saccade.type,size=aes(3))
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50),color=saccade.type,size=3)
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50),color=saccade.type,size=5)
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50),color=saccade.type)+geom_point(aes(size=4))
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50),color=saccade.type)+geom_point(size=4)+facet_wrap(~neuron)
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50),color=saccade.type)+geom_point(size=4,alpha=0.2)+facet_wrap(~neuron)
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50),color=saccade.type)+geom_point(size=4,alpha=1/20)+facet_wrap(~neuron)
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50))+geom_point(color=saccade.type,size=4,alpha=1/20)+facet_wrap(~neuron)
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50))+geom_point(aes(color=saccade.type),size=4,alpha=1/20)+facet_wrap(~neuron)
?geom_point
qplot(peak.R.H,maxfr,data=filter(p,abs(peak.R.H)>50))+geom_point(aes(color=saccade.type,alpha=1/20,size=4))+facet_wrap(~neuron)
ggplot(filter(p,abs(peak.R.H)>50),aes(peak.R.H,maxfr))+geom_point(alpha=1/20)+facet_wrap(~neuron)
ggplot(filter(p,abs(peak.R.H)>50),aes(peak.R.H,maxfr))+geom_point(alpha=1/200)+facet_wrap(~neuron)
ggplot(filter(p,abs(peak.R.H)>50),aes(peak.R.H,maxfr))+geom_point(alpha=1/200,size=5)+facet_wrap(~neuron)
ggplot(filter(p,abs(peak.R.H)>50),aes(peak.R.H,maxfr))+geom_point(aes(color=saccade.type),alpha=1/200,size=5)+facet_wrap(~neuron)
ggplot(filter(p,abs(peak.R.H)>50),aes(peak.R.H,maxfr))+geom_point(aes(color=saccade.type),alpha=1/20,size=5)+facet_wrap(~neuron)
b<- 20
ggplot(filter(pplot,dur<(100+buffer*2)),aes(spiketimes,saccade.type.count*..count..,color=saccade.type,size=2))+geom_freqpoly(bi
head(p)
qplot(counter,verg.velocity,data=p)
p<-mutate(p,peak.verg.velocity=maxabs(verg.velocity))
qplot(peak.verg.velocity,maxfr,data=p)
p %>% group_by(neuron,s) %>% mutate(peak.verg.velocity=maxabs(verg.velocity)) -> p
qplot(peak.verg.velocity,maxfr,data=p)
qplot(verg.amp,maxfr,data=p)
qplot(max.verg.trans,maxfr,data=p,color=verg.amp)+facet_wrap(~neuron,ncol=2)+geom_point(size=3,alpha=1/20)
?coord_cartesian
?coord_polar
g+
# geom_point(alpha=1/30,aes(color=saccade.type))+
stat_smooth(method='auto',size=2,aes(color=R.H.Amp>0))+
facet_wrap(~neuron,ncol=2)+
geom_vline(x=0)+
ggtitle('Average Spike Rate During Saccades')+
ylab('Spike Density Function')+
xlab('Time from Saccade Onset (ms)')+
theme(legend.position="top")
g+
# geom_point(alpha=1/30,aes(color=saccade.type))+
stat_smooth(method='auto',size=2,aes(color=R.V.Amp>0))+
facet_wrap(~neuron,ncol=2)+
geom_vline(x=0)+
ggtitle('Average Spike Rate During Saccades')+
ylab('Spike Density Function')+
xlab('Time from Saccade Onset (ms)')+
theme(legend.position="top")
qplot(r.angle,r.amp,data=p,color=maxfr)+facet_wrap(~neuron,ncol=2)+
coord_polar(theta="x")+
theme(legend.position="top")
g+
# geom_point(alpha=1/30,aes(color=saccade.type))+
stat_smooth(method='auto',size=2,aes(color=saccade.type))+
facet_wrap(~neuron,ncol=2)+
geom_vline(x=0)+
ggtitle('Average Spike Rate During Saccades')+
ylab('Spike Density Function')+
xlab('Time from Saccade Onset (ms)')+
theme(legend.position="top")
qplot(counter[rasters>0],data=p)
qplot(counter[rasters>0],data=p)+facet_wrap(~neuron)
p %>%
group_by(neuron) %>%
do(m=lm(maxfr~verg.angle+peak.verg.velocity,data=.)) ->
x
head(x)
x
x$m
summary(s$m)
summary(x$m)
summary([[x$m]])
summary(x$m[[1]])
??regsubset
head(p)
t%>%
group_by(neuron) %>%
#   mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
#          isfixation=s<0,
#          s=abs(s),
#          sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(dur=n(),
peak.R.H= maxabs(rev),
peak.R.V= maxabs(revV),
peak.L.H= maxabs(lev),
peak.L.V= maxabs(levV),
R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
r.angle=atan2(R.V.Amp,R.H.Amp)*180/pi,
r.amp=sqrt(R.H.Amp^2+R.V.Amp^2),
nspikes=sum(rasters),
vect.amp= (sqrt(R.H.Amp^2+R.V.Amp^2)+sqrt(L.H.Amp^2+L.V.Amp^2))/2,
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
peak.verg.velocity= maxabs(verg.velocity),
min.verg.trans = min(verg.velocity),
max.verg.trans = max(verg.velocity),
maxfr=max(sdf),
counter=time-time[1])%>%
group_by(neuron) %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp > 2,'convergence'),
saccade.type=replace(saccade.type,verg.amp < -2, 'divergence'))->
p
p %>%
filter(peak.verg.velocity>0) %>%
group_by(neuron) %>%
do(b=calc.relimp(lm(maxfr~verg.angle+peak.verg.velocity,data=.)),
bic=regsubsets(maxfr~verg.angle+peak.verg.velocity,.)) ->
bb
library(relaimpo)
library(leaps)
p %>%
filter(peak.verg.velocity>0) %>%
group_by(neuron) %>%
do(b=calc.relimp(lm(maxfr~verg.angle+peak.verg.velocity,data=.)),
bic=regsubsets(maxfr~verg.angle+peak.verg.velocity,.)) ->
bb
plot(bb$b[[1]])
bb$b[[1]]
xt<-bb$b[[1]]
xt$lmb
xt$lmg
head(r)
bb$b[[1]]$lmg
r<-cbind(bb$b[[1]]$lmg,bb$b[[2]]$lmg)
r<-cbind(bb$b[[1]]$lmg,bb$b[[1]]$lmg)
r
r<-rbind(bb$b[[1]]$lmg,bb$b[[1]]$lmg)
r
r<-bb$b[[1]]$lmg
r
r$neuron=bb$[[1]]$neuron
r$neuron=bb$neuron[1]
r$neuron=bb$neuron[[1]]
r
head(r)
rbind(r,r)
rbind(r,r,r)
head(x)
head(rr)
rr<-rbind(r,r)
head(rr)
rr<-rbind(bb[[1]]$lmg,bb[[1]]$lmg)
head(bb)
rr<-rbind(bb$b[[1]]$lmg,bb$b[[1]]$lmg)
rr
r <- data.frame()
for (i in 1:nrow(bb)){
b<- bb$b[[i]]$lmg
b$neuron<- bb$neuron[i]
r=rbind(r,b)
}
r
r <- data.frame()
for (i in 1:nrow(bb)){
b<- as.data.frame(bb$b[[i]]$lmg)
b$neuron<- bb$neuron[i]
r<-rbind(r,b)
}
r
r <- data.frame()
for (i in 1:nrow(bb)){
b<- as.data.frame(lmg=bb$b[[i]]$lmg)
b$neuron<- bb$neuron[i]
r<-rbind(r,b)
}
r <- data.frame()
for (i in 1:nrow(bb)){
b<- bb$b[[i]]$lmg
b$neuron<- bb$neuron[i]
r<-rbind(r,b)
}
b<-bb$b[[1]]$lmg
b
class(b)
as.data.frame(b)
class(b)
b
b[1]
b[2]
rbind(b,b)
bb
r
r<-data.frame()
r<-rbind(r,bb$b[[1]]$lmg)
r
r$colnames<-c('Verg',"vel")
r$rownames
r$colnames
r$cnames
r$names
b
class(b)
as.data.frame(b)
as.data.frame(b,row.names='verg.angle','peak.verg.velocity')
row.names(b)
b
b$rownames
?row.names
row.names(t)
col.names(t)
column.names(t)
names(t)
names(n)
names(b)
r
names(r)<-names(b)
r
qplot(verg.angle,verg.velocity,data=r)
qplot(verg.angle,verg.velocity,data=b)
qplot(verg.angle,verg.velocity,data=r)
r
class(r)
qplot(verg.angle,peak.verg.velocity,data=r)
qplot(verg.angle,peak.verg.velocity,data=r,label=neuron)
r$neuron='bee-01'
qplot(verg.angle,peak.verg.velocity,data=r,label=neuron)
qplot(verg.angle,peak.verg.velocity,data=r,label=neuron)+geom_label()
?geom_label
??geom_label
qplot(verg.angle,peak.verg.velocity,data=r,label=neuron)+geom_text()
qplot(verg.angle,peak.verg.velocity,data=r,label=neuron)+geom_text()+coord_fixed(ratio=1)
qplot(verg.angle,peak.verg.velocity,data=r,label=neuron)+geom_text()+coord_cartesian(xlim=c(0,1),ylim=c(0,1))
?geom_abline
head(b)
bb
bb$b
bb$b[[1]]
xx<0bb$b[[1]]
xx<-bb$b[[1]]
class(xx)
print(xx)
summary(xx)
arg(xx)
xx$arg
x
xx
xx$regressors
xx$lmg
methods(xx)
xx$R2
class(xx$R2)
r2<-data.frame()
r2<-rbind(r2,xx$R2)
r2
names(r2) <- R2
names(r2) <- 'R2'
r2
r2
r2[,]
r2[1,]
r2<- rbind(r2,r2)
r2
r2[1,]
r2[,1]
?scale_color_gradient
install.packages("ggplot2")
?geom_vline
version
g<- ggplot(aes(counter-buffer,sdf),data=filter(p,dur<(80+buffer*2)))
library(ggplot2)
g<- ggplot(aes(counter-buffer,sdf),data=filter(p,dur<(80+buffer*2)))
t%>%
group_by(neuron) %>%
#   mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
#          isfixation=s<0,
#          s=abs(s),
#          sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(dur=n(),
peak.R.H= maxabs(rev),
peak.R.V= maxabs(revV),
peak.L.H= maxabs(lev),
peak.L.V= maxabs(levV),
R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
r.angle=atan2(R.V.Amp,R.H.Amp)*180/pi,
r.amp=sqrt(R.H.Amp^2+R.V.Amp^2),
nspikes=sum(rasters),
vect.amp= (sqrt(R.H.Amp^2+R.V.Amp^2)+sqrt(L.H.Amp^2+L.V.Amp^2))/2,
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
peak.verg.velocity= maxabs(verg.velocity),
min.verg.trans = min(verg.velocity),
max.verg.trans = max(verg.velocity),
maxfr=max(sdf),
counter=time-time[1])%>%
group_by(neuron) %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp > 2,'convergence'),
saccade.type=replace(saccade.type,verg.amp < -2, 'divergence'))->
p
library(dplyr)
t%>%
group_by(neuron) %>%
#   mutate(s=markSaccades((sqrt(rev^2)+sqrt(revV^2))/2,100),
#          isfixation=s<0,
#          s=abs(s),
#          sdf=spikedensity(temp$rasters,sd=20)) %>%
filter(isfixation == F) %>%
group_by(neuron,s) %>%
mutate(dur=n(),
peak.R.H= maxabs(rev),
peak.R.V= maxabs(revV),
peak.L.H= maxabs(lev),
peak.L.V= maxabs(levV),
R.H.Amp=rep[n()]-rep[1],
L.H.Amp=lep[n()]-lep[1],
R.V.Amp=repV[n()]-repV[1],
L.V.Amp=lepV[n()]-lepV[1],
r.angle=atan2(R.V.Amp,R.H.Amp)*180/pi,
r.amp=sqrt(R.H.Amp^2+R.V.Amp^2),
nspikes=sum(rasters),
vect.amp= (sqrt(R.H.Amp^2+R.V.Amp^2)+sqrt(L.H.Amp^2+L.V.Amp^2))/2,
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)),
verg.amp=verg.angle[n()]-verg.angle[1],
peak.verg.velocity= maxabs(verg.velocity),
min.verg.trans = min(verg.velocity),
max.verg.trans = max(verg.velocity),
maxfr=max(sdf),
counter=time-time[1])%>%
group_by(neuron) %>%
mutate(saccade.type='version',
saccade.type=replace(saccade.type,verg.amp > 2,'convergence'),
saccade.type=replace(saccade.type,verg.amp < -2, 'divergence'))->
p
g<- ggplot(aes(counter-buffer,sdf),data=filter(p,dur<(80+buffer*2)))
buffer<- 200
g<- ggplot(aes(counter-buffer,sdf),data=filter(p,dur<(80+buffer*2)))
g+
# geom_point(alpha=1/30,aes(color=saccade.type))+
stat_smooth(method='auto',size=2,aes(color=saccade.type))+
facet_wrap(~neuron,ncol=2)+
geom_vline(xintercept=0)+
ggtitle('Average Spike Rate During Saccades')+
ylab('Spike Density Function')+
xlab('Time from Saccade Onset (ms)')+
theme(legend.position="top")
