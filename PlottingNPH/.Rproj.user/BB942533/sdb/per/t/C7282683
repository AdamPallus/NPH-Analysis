{
    "contents" : "---\ntitle: \"NPHShiny\"\nauthor: \"Adam\"\ndate: \"November 16, 2015\"\noutput: \n  html_document: \n    self_contained: no\nruntime: shiny\n---\n\n---\ntitle: \"BootstrapSaccades\"\nauthor: \"Adam\"\noutput: html_document\n---\n#Introduction\nThis is an analysis of cells believed to be recorded in the NPH of a normal monkey (Bee) and a monkey with exotropia (Patos). The NPH is thought to provide the horizontal integrator for the control of eye movements. Individual neurons in NPH are typically described as either burst-tonic or tonic cells, with activity related to either the position or position and velocity of the eyes. \n\n#Analysis\n* Calclate the lead time for each neuron.\n+ shift data from cell and eye coils to align based on lead time\n* Identify saccades.\n+ for this analysis, we remove periods of fixation\n* fit and evaluate a linear model: Firing Rate ~ eye position/velocity, horizontal/vertical, left/right (8 terms)\n+ Evaluate using Relative Importance\n+ Evaluate using BIC and adjusted R^2, using exhaustive search that finds the best model using 1-8 terms\n* Optionally, we can restrict our analysis to just disjunctive saccades. This can help to identify monocular cells, since the parameters during conjugate saccades are typically well correlated.\n\n\n```{r echo=FALSE} \nlibrary(knitr)\nopts_chunk$set(echo=FALSE)\n```\n\n```{r,message=FALSE}\n\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(knitr)\nlibrary(tidyr)\nlibrary(broom)\nlibrary(grid)\nlibrary(relaimpo)\nlibrary(leaps)\nlibrary(data.table)\n\n```\n\n```{r loadfiles,cache=TRUE}\n#load all the .csv files in the data folder, then add a column naming the neuron, \n#using the file name as the default name, then put them all together in one long data frame\n\n#path<-\"~/GitHub/NPH-Analysis/practicedata/\"\npath<-\"~/GitHub/NPH-Analysis/data/\"\n\ntt<-read.csv(\"AllDataShiny.csv\")\n\n```\n\n\n```{r BICcalc, cache=TRUE}\n#This function can either just calculate the relative importance or use bootstrapping to find a confidence interval for the relative importance. Bootstrapping obviously takes a long time. Also, it can either fit the model to all of the saccades, or just the disjunctive ones. \n\ntt %>%\n  #filter(maxamp>minAmp & disjEither,sdflag>10) %>%\n  group_by(neuron) %>%\n#    do(b=boot.relimp(lm(\"sdflag~rep+rev+repV+revV+lep+lev+lepV+levV\",.),b=1999),\n    do(b=calc.relimp(lm(\"sdflag~rep+rev+repV+revV+lep+lev+lepV+levV\",.)),\n    bic=regsubsets(sdflag~rep+rev+repV+revV+lep+lev+lepV+levV,.)) ->\n  bb\n```\n\n```{R SHINYTRY}\nneurons<-as.character(unique(bb$neuron))\n\ninputPanel(\n  selectizeInput(\"neuronchoice\", label = \"Select a Neuron:\",\n              choices = neurons)\n)\n\nrenderPlot({\n  nc<-input$neuronchoice\n  x<-filter(bb,neuron==nc)\n  plot(x$b[[1]],main=nc)\n  #plot(x$bic[[1]],main=nc)\n})\n\nrenderPlot({\n  nc<-input$neuronchoice\n  x<-filter(bb,neuron==nc)\n  #plot(x$b[[1]],main=nc)\n  plot(x$bic[[1]],main=nc)\n})\n\n```\n\n\n\n",
    "created" : 1447714567994.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "458868617",
    "id" : "C7282683",
    "lastKnownWriteTime" : 1447722005,
    "path" : "~/GitHub/NPH-Analysis/PlottingNPH/shinytest.Rmd",
    "project_path" : "shinytest.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "type" : "r_markdown"
}