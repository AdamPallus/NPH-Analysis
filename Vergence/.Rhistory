manipulate(ggplot(filter(z,time>=window,time<window+5000))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,lev-rev),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev),color='blue')+
geom_line(aes(time,rev),color='red')+
ylim(c(-100,200))
,
window=slider(5000,max(z$time-5000),step=5000))
manipulate(ggplot(filter(z,time>=window,time<window+5000))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,lev-rev),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev),color='blue')+
geom_line(aes(time,rev),color='red')+
# ylim(c(-100,200))
,
window=slider(5000,max(z$time-5000),step=5000))
#Transients are timing?
manipulate(ggplot(filter(z,time>=window,time<window+5000))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,lev-rev)-100,color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev),color='blue')+
geom_line(aes(time,rev),color='red')+
# ylim(c(-100,200))
,
window=slider(5000,max(z$time-5000),step=5000))
manipulate(ggplot(filter(z,time>=window,time<window+5000))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,lev-rev)-100,color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev),color='blue')+
geom_line(aes(time,rev),color='red')
# ylim(c(-100,200))
,
window=slider(5000,max(z$time-5000),step=5000))
manipulate(ggplot(filter(z,time>=window,time<window+5000))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev),color='blue')+
geom_line(aes(time,rev),color='red')
# ylim(c(-100,200))
,
window=slider(5000,max(z$time-5000),step=5000))
manipulate(ggplot(filter(z,time>=window,time<window+5000))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(counter,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(counter,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(counter,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(counter,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(counter,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(counter,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(counter,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(counter,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(counter,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(counter,lag(lev,6)-rev),color='blue',linetype=6)+
# ylim(c(-100,200))
,
window=slider(5000,max(z$time-5000),step=5000))
#Transients are timing?
manipulate(ggplot(filter(z,time>=window,time<window+5000))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(counter,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(counter,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(counter,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(counter,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(counter,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(counter,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(counter,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(counter,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(counter,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(counter,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(5000,max(z$time-5000),step=5000))
#Transients are timing?
manipulate(ggplot(filter(z,time>=window,time<window+5000))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(5000,max(z$time-5000),step=5000))
#Transients are timing?
windowsize<-2000
manipulate(ggplot(filter(z,time>=window,time<window+windowsize))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(windowsize,max(z$time-windowsize),step=windowsize))
windowsize<-2000
manipulate(ggplot(filter(z,time>=window,time<window+windowsize))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
# geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
# geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)
# geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
# geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
# geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
# geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(windowsize,max(z$time-windowsize),step=windowsize))
windowsize<-1000
manipulate(ggplot(filter(z,time>=window,time<window+windowsize))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)
# geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
# geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
# geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
# geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(windowsize,max(z$time-windowsize),step=windowsize))
windowsize<-1000
manipulate(ggplot(filter(z,time>=window,time<window+windowsize))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)
# geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
# geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
# geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
# geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(windowsize,max(z$time-windowsize),step=windowsize))
windowsize<-1000
manipulate(ggplot(filter(z,time>=window,time<window+windowsize))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)
# geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
# geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(windowsize,max(z$time-windowsize),step=windowsize))
windowsize<-1000
manipulate(ggplot(filter(z,time>=window,time<window+windowsize))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(windowsize,max(z$time-windowsize),step=windowsize))
windowsize<-1000
manipulate(ggplot(filter(z,time>=window,time<window+windowsize))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
# geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
# geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
# geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
# geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(windowsize,max(z$time-windowsize),step=windowsize))
manipulate(ggplot(filter(z,time>=window,time<window+windowsize))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
# geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
# geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
# geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
# geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(windowsize,max(z$time-windowsize),step=windowsize))
names(z)
zz<- joinsaccades(z,buffer=200,threshold=20)
bufferlength<- 200
zz %>%
group_by(sacnum) %>%
mutate(verg.amp= verg.angle[n()-bufferlength]-verg.angle[bufferlength]) %>%
filter(verg.amp>3)->
zz
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac])+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
# geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
# geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
# geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
# geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(1,nsac,step=1))
goodsacs<- unique(p$sacnum)
goodsacs<- unique(zz$sacnum)
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
# geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
# geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
# geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
# geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(1,nsac,step=1))
nsac=length(goodsacs)
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
# geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
# geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
# geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
# geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
window=slider(1,nsac,step=1))
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
# geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
# geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
# geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
# geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)
# geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
# geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
sac=slider(1,nsac,step=1))
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
# geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
# geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
# geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
# geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
sac=slider(1,nsac,step=1))
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)
# ylim(c(-100,200))
,
sac=slider(1,nsac,step=1))
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)+
geom_line(aes(time,lev-lag(rev,9)),color='red',linetype=9)+
geom_line(aes(time,lag(lev,9)-rev),color='blue',linetype=9)
# ylim(c(-100,200))
,
sac=slider(1,nsac,step=1))
zz %>%
group_by(sacnum) %>%
mutate(verg.amp= verg.angle[n()-bufferlength]-verg.angle[bufferlength],
conj.position.h=(lep+rep)/2,
conj.position.v=(lepV+repV)/2,
h.amp=conj.position.h[n()-bufferlength]-conj.position.h[bufferlength],
v.amp=conj.position.v[n()-bufferlength]-conj.position.v[bufferlength],
r.amp=sqrt(r.amp^2+v.amp^2)) %>%
filter(r.amp>3)->
zz
zz %>%
group_by(sacnum) %>%
mutate(verg.amp= verg.angle[n()-bufferlength]-verg.angle[bufferlength],
conj.position.h=(lep+rep)/2,
conj.position.v=(lepV+repV)/2,
h.amp=conj.position.h[n()-bufferlength]-conj.position.h[bufferlength],
v.amp=conj.position.v[n()-bufferlength]-conj.position.v[bufferlength],
r.amp=sqrt(h.amp^2+v.amp^2)) %>%
filter(r.amp>3)->
zz
goodsacs<- unique(zz$sacnum)
nsac=length(goodsacs)
windowsize<-1000
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)+
geom_line(aes(time,lev-lag(rev,9)),color='red',linetype=9)+
geom_line(aes(time,lag(lev,9)-rev),color='blue',linetype=9)
# ylim(c(-100,200))
,
sac=slider(1,nsac,step=1))
windowsize<-1000
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,(lev-rev)),color='orange',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)+
geom_line(aes(time,lev-lag(rev,9)),color='red',linetype=9)+
geom_line(aes(time,lag(lev,9)-rev),color='blue',linetype=9)
# ylim(c(-100,200))
,
sac=slider(1,nsac,step=1))
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,(lev-rev)),color='green',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)+
geom_line(aes(time,lev-lag(rev,9)),color='red',linetype=9)+
geom_line(aes(time,lag(lev,9)-rev),color='blue',linetype=9)
# ylim(c(-100,200))
,
sac=slider(1,nsac,step=1))
saveRDS(zz,'TransientDemo.RDS')
# ylim(c(-100,200))
library(manipulate)
library(ggplot2)
zz<- readRDS('TransientDemo.RDS')
goodsacs<- unique(zz$sacnum)
nsac=length(goodsacs)
manipulate(ggplot(filter(zz,sacnum==goodsacs[sac]))+
# geom_area(aes(time,sdf),alpha=1/10)+
geom_line(aes(time,(lev-rev)-100),color='darkblue',alpha=1)+
geom_line(aes(time,(lev-rev)),color='green',alpha=1)+
geom_line(aes(time,enhance.velocity-100),size=2,color='darkblue')+
geom_line(aes(time,(lep-rep)*5-100),color='darkgreen')+
geom_line(aes(time,lev-lag(rev,4)),color='red',linetype=2)+
geom_line(aes(time,lag(lev,4)-rev),color='blue',linetype=2)+
geom_line(aes(time,lev-lag(rev,3)),color='red',linetype=3)+
geom_line(aes(time,lag(lev,3)-rev),color='blue',linetype=3)+
geom_line(aes(time,lev-lag(rev,2)),color='red',linetype=4)+
geom_line(aes(time,lag(lev,2)-rev),color='blue',linetype=4)+
geom_line(aes(time,lev-lag(rev,1)),color='red',linetype=5)+
geom_line(aes(time,lag(lev,1)-rev),color='blue',linetype=5)+
geom_line(aes(time,lev-lag(rev,6)),color='red',linetype=6)+
geom_line(aes(time,lag(lev,6)-rev),color='blue',linetype=6)+
geom_line(aes(time,lev-lag(rev,9)),color='red',linetype=9)+
geom_line(aes(time,lag(lev,9)-rev),color='blue',linetype=9)
# ylim(c(-100,200))
,
sac=slider(1,nsac,step=1))
