ggplot(filter(zpp,verg.amp>0.5))+
geom_point(aes(conj.V.Amp,predicted.verg.amp/verg.amp,color=verg.amp>0))+
stat_smooth(aes(conj.V.Amp,predicted.verg.amp/verg.amp),data=filter(zpp,verg.amp>0.5))+
geom_hline(yintercept=1)+
ylim(-1,2)
ggplot(filter(zpp,verg.amp>0.5))+
geom_point(aes(conj.V.Amp,predicted.verg.amp/verg.amp,color=verg.amp>0))+
stat_smooth(aes(conj.V.Amp,predicted.verg.amp/verg.amp),data=filter(zpp,verg.amp>0.5))+
geom_hline(yintercept=1)
ggplot(filter(zpp,verg.amp>0.5))+
geom_point(aes(conj.V.Amp,predicted.verg.amp/verg.amp,color=conj.H.Amp))+
stat_smooth(aes(conj.V.Amp,predicted.verg.amp/verg.amp),data=filter(zpp,verg.amp>0.5))+
geom_hline(yintercept=1)
qplot(conj.H.Amp,conj.V.Amp,data=zp)
qplot(conj.H.Amp,conj.V.Amp,data=filter(zp,r.amp>1))
qplot(conj.H.Amp,conj.V.Amp,data=filter(zp,r.amp>2))
qplot(conj.H.Amp,conj.V.Amp,data=filter(zp,r.amp>3))
ggplot(filter(zpp,verg.amp>0.5),r.amp>3)+
geom_point(aes(conj.V.Amp,predicted.verg.amp/verg.amp,color=conj.H.Amp))+
stat_smooth(aes(conj.V.Amp,predicted.verg.amp/verg.amp),data=filter(zpp,verg.amp>0.5))+
geom_hline(yintercept=1)
ggplot(filter(zpp,verg.amp>0.5,r.amp>3))+
geom_point(aes(conj.V.Amp,predicted.verg.amp/verg.amp,color=conj.H.Amp))+
stat_smooth(aes(conj.V.Amp,predicted.verg.amp/verg.amp),data=filter(zpp,verg.amp>0.5))+
geom_hline(yintercept=1)
ggplot(filter(zpp,abs(verg.amp)>0.5,r.amp>3))+
geom_point(aes(conj.H.Amp,predicted.verg.amp/verg.amp,color=verg.amp>0))+
stat_smooth(aes(conj.H.Amp,predicted.verg.amp/verg.amp),data=filter(zpp,verg.amp>0.5))+
geom_hline(yintercept=1)+
ylim(-1,2)
zp<-filter(zp,r.amp>3)
qplot(verg.amp,predicted.verg.amp,data=zp)+geom_abline()
qplot(r.angle,predicted.verg.amp/verg.amp,data=filter(zp,abs(verg.amp)>0.5))+
stat_smooth()+
geom_hline(yintercept=1)+
ylim(0,2)
ggplot(filter(zp,abs(verg.amp)>0.5))+
geom_point(aes(r.angle,predicted.verg.amp/verg.amp,color=verg.amp>0))+
stat_smooth(aes(r.angle,predicted.verg.amp/verg.amp),data=filter(zp,verg.amp>0.5))+
geom_hline(yintercept=1)+
ylim(0,2)+
ggtitle('Model= no saccades, converging only')
zp<- summarize_each(z,funs(first))
zp<-filter(zp,r.amp>3)
ggplot(filter(zp,abs(verg.amp)>0.5))+
geom_point(aes(r.angle,predicted.verg.amp/verg.amp,color=verg.amp>0))+
stat_smooth(aes(r.angle,predicted.verg.amp/verg.amp),data=filter(zp,verg.amp>0.5))+
geom_hline(yintercept=1)+
ylim(0,2)+
ggtitle('Model= no saccades, converging only')
ggplot(filter(zp,abs(verg.amp)>0.5,r.amp>3))+
geom_point(aes(conj.H.Amp,predicted.verg.amp/verg.amp,color=verg.amp>0))+
stat_smooth(aes(conj.H.Amp,predicted.verg.amp/verg.amp),data=filter(zp,verg.amp>0.5))+
geom_hline(yintercept=1)+
ylim(-1,2)
ggplot(filter(zp,verg.amp>0.5,r.amp>3))+
geom_point(aes(conj.V.Amp,predicted.verg.amp/verg.amp,color=conj.H.Amp))+
stat_smooth(aes(conj.V.Amp,predicted.verg.amp/verg.amp),data=filter(zp,verg.amp>0.5))+
geom_hline(yintercept=1)
ggplot(filter(zp,abs(verg.amp)>0.5))+
geom_point(aes(r.angle,predicted.verg.amp/verg.amp,color=verg.amp>0))+
stat_smooth(aes(r.angle,predicted.verg.amp/verg.amp),data=filter(zpp,verg.amp>0.5))+
geom_hline(yintercept=1)+
ylim(-1,2)+
ggtitle('Model= no saccades, converging only')
saveModelPlot<- function(x, window=311500,window_size=2000,savename='model',savetype='PNG'){
d=filter(x,time>=window,time<window+window_size)
gs<- ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
geom_line(aes(time,target.verg*10))+
geom_line(aes(time,rep+100),color='red')+
geom_line(aes(time,lep+100),color='blue')+
geom_line(aes(time,repV+100),color='red',linetype=2)+
geom_line(aes(time,lepV+100),color='blue',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))+
ylab('')+
annotate('text',y=100,x=window+200,label='Vergence Angle',color='darkgreen')+
annotate('text',y=80,x=window+200,label='Vergence Velocity',color='darkblue')+
annotate('text',y=70,x=window+200,label='Model',color='orange')+
annotate('text',y=150,x=window+200,label='Vectorial Velocity',color='darkgray')
savename<-paste('plots/',savename,sep='')
ggsave(paste(paste(savename,window,sep='-'),savetype,sep='.'))
}
periodstoplot=as.array(c(203000,209000,228500,233000,243000,244500,249000,256500,
261000,265500,270000,277500,284000,297000,307000,311500))
apply(periodstoplot,1,saveModelPlot,x=x3)
saveModelPlot<- function(x, window=311500,window_size=2000,savename='model',savetype='PNG'){
d=filter(x,time>=window,time<window+window_size)
gs<- ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
geom_line(aes(time,target.verg*10))+
geom_line(aes(time,rep+150),color='red')+
geom_line(aes(time,lep+150),color='blue')+
geom_line(aes(time,repV+150),color='red',linetype=2)+
geom_line(aes(time,lepV+150),color='blue',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))+
ylab('')+
annotate('text',y=100,x=window+200,label='Vergence Angle',color='darkgreen')+
annotate('text',y=80,x=window+200,label='Vergence Velocity',color='darkblue')+
annotate('text',y=70,x=window+200,label='Model',color='orange')+
annotate('text',y=150,x=window+200,label='Vectorial Velocity',color='darkgray')
savename<-paste('plots/',savename,sep='')
ggsave(paste(paste(savename,window,sep='-'),savetype,sep='.'))
}
apply(periodstoplot,1,saveModelPlot,x=x3)
qplot(r.angle,predicted.verg.amp/verg.amp,data=filter(zp,abs(verg.amp)>0.5))+
stat_smooth()+
geom_hline(yintercept=1)+
ylim(0,2)
qplot(verg.amp,predicted.verg.amp,data=zp)+geom_abline()
qplot(verg.amp,predicted.verg.amp,data=zp,color=r.angle)+geom_abline()
qplot(verg.amp,predicted.verg.amp,data=zp,color=r.angle>0)+geom_abline()
qplot(verg.amp,predicted.verg.amp,data=zp,color=rightward<-r.angle>0)+geom_abline()
qplot(verg.amp,predicted.verg.amp,data=zp,color=sign(r.angle))+geom_abline()
aov(verg.amp~sign(r.angle),data=filter(zp,verg.amp<0))
summary(aov(verg.amp~sign(r.angle),data=filter(zp,verg.amp<0)))
summary(aov(verg.amp~sign(r.angle),data=filter(zp,verg.amp>0)))
plot(aov(verg.amp~sign(r.angle),data=filter(zp,verg.amp<0)))
ggplot(zp)+
geom_boxplot(aes(sign(r.angle),verg.amp))+
facet_wrap(~sign(verg.amp))
ggplot(zp)+
geom_boxplot(aes(as.factor(sign(r.angle)),verg.amp))+
facet_wrap(~sign(verg.amp))
zp$rl=as.factor(sign(r.angle))
zp$rl=as.factor(sign(zp$r.angle))
levels(zp$rl)
levels(zp$rl)<- c('Leftward','Rightward')
zp$cd=as.factor(sign(zp$verg.amp))
levels(zp$cd)
levels(zp$cd)<- c('Diverging','Converging')
levels(zp$cd)
ggplot(zp)+
geom_boxplot(aes(rl,verg.amp))+
facet_wrap(~cd)
ggplot(zp)+
geom_boxplot(aes(rl,verg.amp))+
facet_wrap(~cd)+
ylab("Vergence Amplitude (deg)")+
xlab("Saccade Direction")
summary(aov(verg.amp~rl,data=zp))
summary(aov(verg.amp~rl+cd,data=zp))
summary(aov(verg.amp~rl,data=filter(zp(cd=='Converging'))))
summary(aov(verg.amp~rl,data=filter(zp,cd=='Converging')))
summary(aov(verg.amp~rl,data=filter(zp,cd=='Diverging')))
qplot(verg.amp,predicted.verg.amp,data=zp,color=rl))+geom_abline()
qplot(verg.amp,predicted.verg.amp,data=zp,color=rl)+geom_abline()
manipulate({
d=filter(z,time>=window,time<window+window_size)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,150))+
geom_point(aes(time,saccadic*50))+
geom_line(aes(time,target.verg*10))
# geom_line(aes(time,(target.verg-verg.angle)*10),color='hotpink')
},
window_size=slider(1000,5000,step=100,initial = 4000),
window=slider(window_size,max(z$time-window_size),step=100))
manipulate({
d=filter(z,time>=window,time<window+window_size)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,150))+
geom_point(aes(time,saccadic*50))+
geom_line(aes(time,target.verg*10))
# geom_line(aes(time,(target.verg-verg.angle)*10),color='hotpink')
},
window_size=slider(1000,5000,step=100,initial = 4000),
window=slider(window_size,max(z$time-window_size),step=1000))
saveplot(x=x3,window=417000)
saveModelPlot(x=x3,window=417000)
saveModelPlot(x=x3,window=433000)
d=filter(x3,sacnum==1)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
d=filter(z,sacnum==1)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
p<- filter(z,verg.amp>5)
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1:length(goodsacs)))
p<- filter(z,verg.amp>5)
goodsacs=unique(p$sacnum)
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1:length(goodsacs)))
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1,length(goodsacs)))
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
starttime=first(d$time)
stoptime=starttime+1000
d=filter(z,time>=starttime,time<stoptime)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1,length(goodsacs)))
saveModelPlot(x=x3,window=24600)
saveModelPlot(x=x3,window=24500)
saveModelPlot(x=x3,window=24400)
saveModelPlot(x=x3,window=24200)
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
starttime=first(d$time)
stoptime=starttime+500
d=filter(z,time>=starttime,time<stoptime)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1,length(goodsacs)))
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
starttime=first(d$time)
stoptime=starttime+200
d=filter(z,time>=starttime,time<stoptime)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1,length(goodsacs)))
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
starttime=first(d$time)
stoptime=starttime+300
d=filter(z,time>=starttime,time<stoptime)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1,length(goodsacs)))
p<- filter(z,predicted.verg.amp>verg.amp)
goodsacs=unique(p$sacnum)
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
starttime=first(d$time)
stoptime=starttime+300
d=filter(z,time>=starttime,time<stoptime)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1,length(goodsacs)))
p<- filter(z,predicted.verg.amp>verg.amp,verg.amp>0)
goodsacs=unique(p$sacnum)
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
starttime=first(d$time)
stoptime=starttime+300
d=filter(z,time>=starttime,time<stoptime)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1,length(goodsacs)))
p<- filter(z,predicted.verg.amp>verg.amp,verg.amp>2)
goodsacs=unique(p$sacnum)
manipulate(
{
d=filter(z,sacnum==goodsacs[plotsac])
starttime=first(d$time)
stoptime=starttime+300
d=filter(z,time>=starttime,time<stoptime)
ggplot(d)+
geom_point(aes(time,showrasters+30),shape='|')+
# geom_point(aes(time,showenhance*verg.velocity),color='magenta')+
# geom_area(aes(time,sdf),color='black',fill='pink',alpha=1/10)+
# geom_line(aes(time,slowpredict),color='orange')+
geom_line(aes(time,verg.angle*10+0),color='darkgreen')+
# geom_line(aes(time,predP/1000),color='darkgreen',linetype=2)+
geom_line(aes(time,predV),color='orange')+
# geom_line(aes(time,predV2),color='magenta')+
geom_line(aes(time,verg.velocity),color='darkblue')+
geom_area(aes(time,conj.velocity),alpha=1/3)+
geom_line(aes(time,cumsum(predV)/100+first(verg.angle)*10),color='orange',linetype=2)+
# geom_line(aes(time,verg.velocity-predV),color='red',linetype=2)
ylim(c(NA,200))
},
plotsac=slider(1,length(goodsacs)))
saveModelPlot(x=x3,window=35500)
saveModelPlot(x=x3,window=35200)
saveModelPlot(x=x3,window=35400,window_size=1000)
saveModelPlot(x=x3,window=35000)
saveModelPlot(x=x3,window=34500)
saveModelPlot(x=x3,window=34000)
saveModelPlot(x=x3,window=35500,window_size=1000)
saveModelPlot(x=x3,window=33500,window_size=3000)
saveModelPlot(x=x3,window=36500)
saveModelPlot(x=x3,window=5900)
saveModelPlot(x=x3,window=59000)
saveModelPlot(x=x3,window=59000,window_size=1000)
saveModelPlot(x=x3,window=81000)
saveModelPlot(x=x3,window=35500,window_size=1000)
zp$rl=as.factor(sign(zp$r.angle))
levels(zp$rl)<- c('Upward','Downward')
zp$cd=as.factor(sign(zp$verg.amp))
levels(zp$cd)<- c('Diverging','Converging')
ggplot(zp)+
geom_boxplot(aes(rl,verg.amp))+
facet_wrap(~cd)+
ylab("Vergence Amplitude (deg)")+
xlab("Saccade Direction")
qplot(verg.amp,predicted.verg.amp,data=zp,color=rl)+geom_abline()
zp$rl=as.factor(sign(zp$r.angle))
levels(zp$rl)
levels(zp$rl)<- c('Downard','Upward')
ggplot(zp)+
geom_boxplot(aes(SaccadeDirection,verg.amp))+
facet_wrap(~cd)+
ylab("Vergence Amplitude (deg)")+
xlab("Saccade Direction")
zp$SaccadeDirection=as.factor(sign(zp$r.angle))
levels(zp$SaccadeDirection)<- c('Downard','Upward')
zp$cd=as.factor(sign(zp$verg.amp))
levels(zp$cd)<- c('Diverging','Converging')
ggplot(zp)+
geom_boxplot(aes(SaccadeDirection,verg.amp))+
facet_wrap(~cd)+
ylab("Vergence Amplitude (deg)")+
xlab("Saccade Direction")
qplot(verg.amp,predicted.verg.amp,data=zp,color=SaccadeDirection)+geom_abline()
