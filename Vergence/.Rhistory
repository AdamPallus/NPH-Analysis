theme_minimal()+
xlab('Direction preference away from vertical')+
ylab(bquote(~R^2))
ggplot(zmc %>% filter(any.sig))+
geom_point(aes(90-abs(dir.pref.imp),R2,color=monkey),size=2)+
theme_minimal()+
xlab('Direction preference away from vertical')+
ylab(bquote(~R^2))
ggplot(zmc %>% filter(any.sig))+
geom_segment(aes(y=0,yend=R2,x=dir.pref.imp,xend=dir.pref.imp,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
ggplot(zmc)+
geom_segment(aes(y=0,yend=R2,x=dir.pref.imp,xend=dir.pref.imp,color=any.sig))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~cellnum<921,ncol=2)+
xlab('Direction preference\nusing relative importance')
head(zmc)
names(zmc)
names(zp)
qplot(zp$mean.conj.velocity)
qplot(zp$mean.conj.velocity,fill='monkey')
qplot(zp$mean.conj.velocity,fill=monkey)
zp %>%
group_by(neuron) %>%
filter(meanFR>3,mean.conj.velocity<3) %>%
do(conj.measureCell(.)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zmc
names(zp)
zp %>%
group_by(neuron) %>%
filter(meanFR>1,mean.conj.velocity<3) %>%
do(conj.measureCell(.)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zmc
zp %>%
group_by(neuron) %>%
filter(meanFR>1,abs(mean.conj.velocity)<3) %>%
do(conj.measureCell(.)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zmc
zp %>%
group_by(neuron) %>%
# filter(meanFR>1,abs(mean.conj.velocity)<3) %>%
do(conj.measureCell(.)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zmc
zp %>%
filter(meanFR>1,abs(mean.conj.velocity)<3) %>%
group_by(neuron) %>%
do(conj.measureCell(.)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zmc
zp %>%
filter(abs(mean.conj.velocity)<3) %>%
group_by(neuron) %>%
do(conj.measureCell(.)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zmc
ggplot(zmc)+
geom_segment(aes(y=0,yend=1,x=dir.pref.imp,xend=dir.pref.imp,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
ggplot(zmc %>% filter(any.sig))+
geom_segment(aes(y=0,yend=1,x=dir.pref.imp,xend=dir.pref.imp,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
zp %>%
filter(abs(mean.conj.velocity)<3) %>%
group_by(neuron) %>%
do(measureCell(.)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zm
names(zm)
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
library(plotly)
ggplotly(ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey,label=neuron))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
)
qplot(dir.imp.R,data=zm)
qplot(dir.imp.R,data=zm,fill=monkey)
filter(zm,monkey=='Bee',abs(dir.imp.R)>50)
filter(zm,monkey=='Bee',abs(dir.imp.R)>50)$dir.imp.R
t<- filter(neuron !%in% c('Bee-10','Bee-12','Bee-81','Bee-82'))
t<- filter(t,neuron !%in% c('Bee-10','Bee-12','Bee-81','Bee-82'))
t<- filter(t,!neuron %in% c('Bee-10','Bee-12','Bee-81','Bee-82'))
t %>%
group_by(neuron)%>%
mutate(time=row_number()) %>%
filter(dsnum<0) %>% #fixations only
group_by(neuron,dsnum) %>%
summarize(sd.conj.velocity=sd(conj.velocity),
mean.conj.velocity=mean(conj.velocity),
spread=max(conj.velocity)-min(conj.velocity),
qrange=quantile(conj.velocity,0.975)-quantile(conj.velocity,0.025),
dur=n(),
starttime=first(time),
c2eyes=cor(repV,lepV),
meanFR=sum(rasters)/dur*1000,
mean.V=mean(conj.vert),
mean.H=mean(conj.hor),
mean.R.H=mean(rep),
mean.L.H=mean(lep),
mean.R.V=mean(repV),
mean.L.V=mean(lepV),
mean.T.V=mean(tvp),
mean.T.H=mean(thp),
sd.sdf=sd(sdf10),
asleep=sd.conj.velocity>7.5 || dur>2000)->
zp
zp %>%
filter(abs(mean.conj.velocity)<3) %>%
group_by(neuron) %>%
do(measureCell(.)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zm
ggplot(zm))+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey,label=neuron))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
ggplot(zm))+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey,label=neuron))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
ggplot(zm))+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
ggplot(zm))+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
head(zm)
zm$dir.imp.R
ggplot(zm))+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance'),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2R,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance'),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2R,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance'),
ncols=1
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance'),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2R,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance'),
ncols=2
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance'),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2R,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance'),
cols=2
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance'),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2R,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')+
ylab('R-squared'),
cols=2
)
zm %>%
group_by(monkey) %>%
tally()
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.pref.R,xend=dir.pref.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance'),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2R,x=dir.pref.R,xend=dir.pref.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')+
ylab('R-squared'),
cols=2
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.pref.R,xend=dir.pref.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES'),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2R,x=dir.pref.R,xend=dir.pref.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES')+
ylab('R-squared'),
cols=2
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.pref.R,xend=dir.pref.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES')+
ylab(''),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2R,x=dir.pref.R,xend=dir.pref.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES')+
ylab('R-squared'),
cols=2
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')+
ylab(''),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2R,x=dir.imp.R,xend=dir.imp.R,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')+
ylab('R-squared'),
cols=2
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.L,xend=dir.imp.L,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')+
ylab(''),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2L,x=dir.imp.L,xend=dir.imp.L,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')+
ylab('R-squared'),
cols=2
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.pref.L,xend=dir.pref.L,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES')+
ylab(''),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2L,x=dir.pref.L,xend=dir.pref.L,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES')+
ylab('R-squared'),
cols=2
)
multiplot(
ggplot(zm)+
geom_segment(aes(y=0,yend=1,x=dir.imp.L,xend=dir.imp.L,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')+
ylab(''),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2L,x=dir.imp.L,xend=dir.imp.L,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing relative importance')+
ylab('R-squared'),
cols=2
)
zm %>%
group_by(monkey) %>%
tally()
zp %>%
filter(abs(mean.conj.velocity)<3) %>%
group_by(neuron) %>%
do(conj.measureCell(.)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zmc
names(zmc)
multiplot(
ggplot(zmc)+
geom_segment(aes(y=0,yend=1,x=dir.pref.slope,xend=dir.pref.slope,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES')+
ylab(''),
ggplot(zm)+
geom_segment(aes(y=0,yend=R2,x=dir.pref.slope,xend=dir.pref.slope,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES')+
ylab('R-squared'),
cols=2
)
names(zmc)
multiplot(
ggplot(zmc)+
geom_segment(aes(y=0,yend=1,x=dir.pref.slope,xend=dir.pref.slope,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES')+
ylab(''),
ggplot(zmc)+
geom_segment(aes(y=0,yend=R2,x=dir.pref.slope,xend=dir.pref.slope,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing SLOPES')+
ylab('R-squared'),
cols=2
)
multiplot(
ggplot(zmc)+
geom_segment(aes(y=0,yend=1,x=dir.pref.imp,xend=dir.pref.imp,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing Importance')+
ylab(''),
ggplot(zmc)+
geom_segment(aes(y=0,yend=R2,x=dir.pref.imp,xend=dir.pref.imp,color=monkey))+
scale_x_continuous(limits=c(-180,180),breaks=c(0,90,180,-90))+
coord_polar(start=pi/2,direction=-1)+
theme_minimal()+
theme(legend.position='none')+
facet_wrap(~monkey,ncol=1)+
xlab('Direction preference\nusing Importance')+
ylab('R-squared'),
cols=2
)
