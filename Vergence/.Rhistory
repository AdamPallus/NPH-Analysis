library(cladoRcpp)
library(boot)
source('Adamhelperfunctions.R')
select<- dplyr::select
t<-readRDS('KopachuckINC Wed Sep 13')
t %>% group_by(neuron) %>%
mutate(time=row_number()) ->
t
t%>%
group_by(neuron) %>%
mutate(sdf=spikedensity(rasters,10),
sdf10=lag(sdf,10),
conj.VP=(lepV+repV)/2,
conj.HP=(lep+rep)/2,
conj.VV=(levV+revV)/2,
conj.HV=(lev+rev)/2)->
t
t %>% group_by(neuron) %>%
do(joinsaccadesuniform(.,buffer=50,threshold=30))->
ts
ts %>%
group_by(neuron) %>%
# mutate(bin.velocity=cut(verg.velocity,c(seq(-200,200,by=20)))) %>%
# filter(!is.na(sacnum)) %>%
group_by(neuron, sacnum) %>%
mutate(peak.H.vel=maxabs(lev+rev)/2,
peak.V.vel=maxabs((levV+revV)/2),
conj.h=(lep+rep)/2,
conj.v=(lepV+repV)/2,
conj.h.amp=last(conj.h)-first(conj.h),
conj.v.amp=last(conj.v)-first(conj.v),
conj.angle=atan2(conj.v,conj.h)*180/pi,
peak.verg.velocity=maxabs(verg.velocity),
r.amp=sqrt(conj.h.amp^2+conj.v.amp^2),
peak.FR=max(sdf10)) ->
ts
ts %>%
group_by(neuron,sacnum) %>%
summarize(saccade.amp=first(r.amp),
peak.H.vel=first(peak.H.vel),
peak.V.vel=first(peak.V.vel),
peak.FR=first(peak.FR),
conj.h.amp=first(conj.h.amp),
conj.v.amp=first(conj.v.amp)) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
sp
qplot(conj.h.amp,peak.FR,data=filter(sp,abs(conj.h.amp)>4))+
facet_wrap(~neuron,scales='free',ncol=3)+
stat_smooth(method='lm')+
xlab('Horizontal Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')
5+5
qplot(conj.h.amp,peak.FR,data=filter(sp,abs(conj.h.amp)>4))+
facet_wrap(~neuron,scales='free',ncol=3)+
stat_smooth(method='lm')+
xlab('Horizontal Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')
qplot(conj.h.amp,peak.FR,data=filter(sp,abs(conj.h.amp)>4))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
stat_smooth(method='lm')+
xlab('Horizontal Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')
qplot(conj.h.amp,peak.FR,data=filter(sp,abs(conj.h.amp)>4))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Horizontal Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')
qplot(conj.v.amp,peak.FR,data=filter(sp,abs(conj.h.amp)>4))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Vertical Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')
t<-readRDS('KopachuckINC Wed Sep 13')
ggplot(aes(conj.v.amp,peak.FR),data=filter(sp,abs(conj.h.amp)>4))+
geom_point(aes(color=neuron))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Vertical Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')
ggplot(aes(conj.v.amp,peak.FR),data=filter(sp,abs(conj.h.amp)>4))+
geom_point(aes(color=neuron))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Vertical Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')+
theme(legend=FALSE)
ggplot(aes(conj.v.amp,peak.FR),data=filter(sp,abs(conj.h.amp)>4))+
geom_point(aes(color=neuron))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Vertical Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')+
theme(legend=NULL)
ggplot(aes(conj.v.amp,peak.FR),data=filter(sp,abs(conj.h.amp)>4))+
geom_point(aes(color=neuron))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Vertical Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')+
theme(legend.position="none")
ggplot(aes(conj.v.amp,peak.FR),data=filter(sp,abs(conj.h.amp)>4))+
geom_point(aes(color=neuron))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Vertical Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')+
theme(legend.position="none")+
geom_vline(xintercept = 0)
ggplot(aes(conj.h.amp,peak.FR),data=filter(sp,abs(conj.h.amp)>4))+
geom_point(aes(color=neuron))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Horizontal Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')+
theme(legend.position="none")+
geom_vline(xintercept = 0)
ggplot(aes(conj.h.amp,peak.FR),data=filter(sp,abs(conj.h.amp+conj.v.amp)>4))+
geom_point(aes(color=neuron))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Horizontal Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')+
theme(legend.position="none")+
geom_vline(xintercept = 0)
ggplot(aes(conj.v.amp,peak.FR),data=filter(sp,abs(conj.h.amp+conj.v.amp)>4))+
geom_point(aes(color=neuron))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Vertical Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')+
theme(legend.position="none")+
geom_vline(xintercept = 0)
ggplot(aes(conj.h.amp,peak.FR),data=filter(sp,abs(conj.h.amp+conj.v.amp)>4))+
geom_point(aes(color=neuron))+
facet_wrap(~monkey)+
# facet_wrap(~neuron,scales='free',ncol=3)+
# stat_smooth(method='lm')+
xlab('Horizontal Saccade Amplitude (deg)')+
ylab('Peak firing rate (deg/s)')+
theme(legend.position="none")+
geom_vline(xintercept = 0)
t %>%
group_by(neuron) %>%
mutate(dsnum=markSaccadesDouble(conj.velocity),
sdf=spikedensity(rasters,10),
sdf10=lag(sdf,10),
conj.vert=(repV+lepV)/2,
conj.vert.vel=(revV+levV)/2,
conj.hor=(rep+lep)/2,
conj.hor.v=(rev+lev)/2) %>%
group_by(dsnum) %>%
mutate(sd.conj.velocity=sd(conj.velocity),
dur=n(),
asleep=(sd.conj.velocity>7.5 & dsnum<0) || dur>2000)->
t
source('~/GitHub/NPH-Analysis/Vergence/markSaccadesDouble2.R')
t %>%
group_by(neuron) %>%
mutate(dsnum=markSaccadesDouble(conj.velocity,threshold1=30,threshold2=15),
sdf=spikedensity(rasters,10),
sdf10=lag(sdf,10),
conj.vert=(repV+lepV)/2,
conj.vert.vel=(revV+levV)/2,
conj.hor=(rep+lep)/2,
conj.hor.v=(rev+lev)/2) %>%
group_by(dsnum) %>%
mutate(sd.conj.velocity=sd(conj.velocity),
dur=n(),
asleep=(sd.conj.velocity>7.5 & dsnum<0) || dur>2000)->
t
t %>%
group_by(neuron) %>%
mutate(time=row_number()) %>%
filter(dsnum>0) %>% #saccades only - no buffer
group_by(neuron,dsnum) %>%
summarize(dur=n(),
peakFR=max(sdf10),
R.H.Amp=rep[1]-last(rep),
L.H.Amp=lep[1]-last(lep),
R.V.Amp=repV[1]-last(repV),
L.V.Amp=lepV[1]-last(lepV))->
zp
nrow(zp)
t %>%
group_by(neuron) %>%
mutate(time=row_number()) %>%
filter(dsnum>0) %>% #saccades only - no buffer
group_by(neuron,dsnum) %>%
summarize(dur=n(),
peakFR=max(sdf10),
R.H.Amp=rep[1]-last(rep),
L.H.Amp=lep[1]-last(lep),
R.V.Amp=repV[1]-last(repV),
L.V.Amp=lepV[1]-last(lepV),
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)))->
zp
nrow(filter(zp,maxamp>1))
nrow(filter(zp,maxamp>2))
nrow(filter(zp,maxamp>5))
nrow(filter(zp,maxamp>10))
nrow(filter(zp,maxamp>20))
t %>%
group_by(neuron) %>%
mutate(time=row_number()) %>%
filter(dsnum>0) %>% #saccades only - no buffer
group_by(neuron,dsnum) %>%
summarize(dur=n(),
peakFR=max(sdf10),
R.H.Amp=rep[1]-last(rep),
L.H.Amp=lep[1]-last(lep),
R.V.Amp=repV[1]-last(repV),
L.V.Amp=lepV[1]-last(lepV),
conj.h.amp=(R.H.Amp+L.H.Amp)/2,
conj.v.amp=(R.V.Amp+L.V.Amp)/2,
r.amp=sqrt(conj.h.amp^2+conj.v.amp^2),
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp)))->
zp
nrow(filter(zp,r.amp>4))
head(zp)
t %>%
group_by(neuron) %>%
mutate(time=row_number()) %>%
filter(dsnum>0) %>% #saccades only - no buffer
group_by(neuron,dsnum) %>%
summarize(dur=n(),
peakFR=max(sdf10),
R.H.Amp=rep[1]-last(rep),
L.H.Amp=lep[1]-last(lep),
R.V.Amp=repV[1]-last(repV),
L.V.Amp=lepV[1]-last(lepV),
conj.h.amp=(R.H.Amp+L.H.Amp)/2,
conj.v.amp=(R.V.Amp+L.V.Amp)/2,
r.amp=sqrt(conj.h.amp^2+conj.v.amp^2),
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp))) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zp
qplot(conj.v.amp,peakFR,data=filter(zp,r.amp>3),color=monkey)
qplot(conj.v.amp,peakFR,data=filter(zp,r.amp>3),color=neuron)+
facet_wrap(~monkey)
qplot(conj.v.amp,peakFR,data=filter(zp,r.amp>3),color=neuron)+
facet_wrap(~monkey)+
theme(legend.positon='none')
qplot(conj.v.amp,peakFR,data=filter(zp,r.amp>3),color=neuron)+
facet_wrap(~monkey)+
theme(legend.position='none')
t %>%
group_by(neuron) %>%
mutate(time=row_number()) %>%
filter(dsnum>0) %>% #saccades only - no buffer
group_by(neuron,dsnum) %>%
summarize(dur=n(),
peakFR=max(sdf10),
R.H.Amp=last(rep)-rep[1],
L.H.Amp=last(lep)-lep[1],
R.V.Amp=last(repV)-repV[1],
L.V.Amp=last(lepV)-lepV[1],
conj.h.amp=(R.H.Amp+L.H.Amp)/2,
conj.v.amp=(R.V.Amp+L.V.Amp)/2,
r.amp=sqrt(conj.h.amp^2+conj.v.amp^2),
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp))) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zp
qplot(conj.v.amp,peakFR,data=filter(zp,r.amp>3),color=neuron)+
facet_wrap(~monkey)+
theme(legend.position='none')
t %>%
group_by(neuron) %>%
mutate(time=row_number(),
rasters10=lag(rasters,10)) %>%
filter(dsnum>0) %>% #saccades only - no buffer
group_by(neuron,dsnum) %>%
summarize(dur=n(),
peakFR=max(sdf10),
nspklag=sum(rasters10),
nspk=sum(rasters),
R.H.Amp=last(rep)-rep[1],
L.H.Amp=last(lep)-lep[1],
R.V.Amp=last(repV)-repV[1],
L.V.Amp=last(lepV)-lepV[1],
conj.h.amp=(R.H.Amp+L.H.Amp)/2,
conj.v.amp=(R.V.Amp+L.V.Amp)/2,
r.amp=sqrt(conj.h.amp^2+conj.v.amp^2),
maxamp=max(abs(R.H.Amp),abs(R.V.Amp),abs(L.H.Amp),abs(L.V.Amp))) %>%
separate(neuron,c('monkey','cellnum'),remove=FALSE)->
zp
qplot(conj.v.amp,nspklag,data=filter(zp,r.amp>3),color=neuron)+
facet_wrap(~monkey)+
theme(legend.position='none')
qplot(conj.v.amp,nspklag,data=filter(zp,r.amp>3,dur<150),color=neuron)+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(data=filter(zp,r.amp>3,dur<150))+
stat_smooth(method='lm',aes(group=neuron),se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(data=filter(zp,r.amp>3,dur<150))+
stat_smooth(aes(conj.v.amp,nspklag,group=neuron),method='lm'),se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(data=filter(zp,r.amp>3,dur<150))+
stat_smooth(aes(conj.v.amp,nspklag,group=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(data=filter(zp,r.amp>3,dur<150))+
stat_smooth(aes(conj.v.amp,nspk,group=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(data=filter(zp,r.amp>3,dur<150))+
stat_smooth(aes(conj.v.amp,nspk,group=neuron),method='lm',se=FALSE,color='black')+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(data=filter(zp,r.amp>3,dur<150))+
stat_smooth(aes(conj.h.amp,nspk,group=neuron),method='lm',se=FALSE,color='black')+
facet_wrap(~monkey)+
theme(legend.position='none')
qplot(conj.v.amp,nspklag,data=filter(zp,r.amp>3,dur<150,dur>50),color=neuron)+
facet_wrap(~monkey)+
theme(legend.position='none')
qplot(conj.v.amp,peakFR,data=filter(zp,r.amp>3,dur<150,dur>50),color=neuron)+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(data=filter(zp,r.amp>3,dur<150,dur>50))+
stat_smooth(aes(conj.v.amp,nspk,group=neuron),method='lm',se=FALSE,color='black')+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(aes(conj.v.amp,nspk),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point()+
stat_smooth(aes(group=neuron),method='lm',se=FALSE,color='black')+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(aes(conj.v.amp,nspk),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron))+
stat_smooth(aes(group=neuron),method='lm',se=FALSE,color='black')+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(aes(conj.v.amp,nspk),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')
ggplot(aes(conj.v.amp,nspk),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)
ggplot(aes(conj.v.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)
ggplot(aes(conj.h.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)
ggplot(aes(conj.h.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Horizontal Saccade Amplitude')+
ylab('Number of Spikes')
ggplot(aes(conj.h.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/5))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Horizontal Saccade Amplitude')+
ylab('Number of Spikes')
ggplot(aes(conj.h.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Horizontal Saccade Amplitude')+
ylab('Number of Spikes')
ggplot(aes(conj.v.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(R.V.Amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Right Eye Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(L.V.Amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Left Eye Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(R.V.Amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlim(-40,40)+
xlab('Right Eye Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(L.V.Amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlim(-40,40)+
xlab('Left Eye Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(L.V.Amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50,conj.v.amp<1))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlim(-40,40)+
xlab('Left Eye Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(L.V.Amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50,abs(conj.h.amp)<1))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlim(-40,40)+
xlab('Left Eye Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(R.V.Amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50,abs(conj.h.amp)<1))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlim(-40,40)+
xlab('Right Eye Vertical Saccade Amplitude')+
ylab("Number of Spikes")+
ggtitle('Only Vertical Saccades')
ggplot(aes(R.V.Amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~monkey)+
theme(legend.position='none')+
ylim(0,NA)+
xlim(-40,40)+
xlab('Right Eye Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(conj.v.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~neuron,ncol=5)+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(conj.v.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~neuron,ncol=5,scale_x='free')+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(conj.v.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=neuron,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~neuron,ncol=5,scale='free_x')+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(conj.v.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=monkey,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~neuron,ncol=5,scale='free_x')+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Vertical Saccade Amplitude')+
ylab("Number of Spikes")
ggplot(aes(conj.h.amp,nspklag),data=filter(zp,r.amp>3,dur<150,dur>50))+
geom_point(aes(color=monkey,alpha=1/10))+
stat_smooth(aes(group=neuron,color=neuron),method='lm',se=FALSE)+
facet_wrap(~neuron,ncol=5,scale='free_x')+
theme(legend.position='none')+
ylim(0,NA)+
xlab('Horizontal Saccade Amplitude')+
ylab("Number of Spikes")
